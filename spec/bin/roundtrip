#!/usr/bin/env ruby
# Script to dynamically create specs trying to correctly roundtrip all the .puz files that get
# passed in

if ARGV.size < 1
  puts 'Puzzle file(s) required!'
  puts 'Usage: roundtrip </path/to/puzfile.puz>...'
  puts 'exiting...'
end

require File.expand_path('../../spec_helper', __FILE__)

describe 'Roundtrip tests' do
  ARGV.each do |f|
    if File.exists?(f)
      if Roundtripper::ROUNDTRIP_INVALIDS.include?(f)
        xit "is known invalid #{f}"
      else
        it "should roundtrip #{f}" do
          should_roundtrip_puz_file(f, true)
        end
      end
    else
      puts "File #{f} not found"
    end
  end
end

# Force lack of fail_fast in case it is set in ~/.rspec
# There's no --no-fail-fast option to do this the easy way
options = RSpec::Core::ConfigurationOptions.new([])
options.options[:fail_fast] = false
RSpec::Core::Runner.new(options).run($stderr, $stdout)

